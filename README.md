# ResNet50_BestLoss
ResNet50 모델을 이용해서 benign vs melanoma 예측하기(best min loss 기준)

# Result
- melanoma vs benign classification problem을 resNet모델을 이용해서 예측, 평가했는데 batch size가 16일때 모든 지표(acc, auc, precision, recall)가 가장 잘나왔다.
- 배치 64, 128이 2,3번째로 성능이 좋았다. 그런데 배치 64일때는 accuracy는 128보다 높은데 auc는 또 128일때가 64일때보다 더 컸다. 배치사이즈 32일때는 4가지 케이스 중 가장 낮게 나왔다.

# Analysis
- batch size 분석
  - 작은 배치: 더 나은 일반화 성능(학습 과정에 잡음을 추가하여 모델이 다양한 데이터 패턴을 학습), 모델 학이 불안정할 가능성 있음(경사 하강의 변동성을 증가, 수렴하지 못할 위험이 생김).
  - 큰 배치: 학습 안정화(경사 하강의 변동성을 줄인다, noise 낮춰 빨리 수렴), 일반화 성능 저하될 수 있음(지역 최적점(local minima)에 갇힐 위험). 학습 데이터에 과적합되어 예측 성능이 떨어질 수 있음.

- 배치 크기에 따른 변화
   - 일반적으로 **작은 배치 크기(예: 16)**는 노이즈가 많지만, 모델이 다양한 패턴을 학습할 수 있도록 유도해서 일반화 성능이 더 좋아질 가능성이 있음.
   - 반면, **큰 배치 크기(예: 128)**는 모델이 안정적으로 학습되지만, 국소적인 최적점(local minima)에 갇힐 위험이 있음.
   - 배치 16에서 모든 지표가 가장 잘 나왔다는 것은 모델이 일반화 성능을 가장 잘 유지하고 있다는 뜻
   - 배치 32에서 가장 성능이 낮았다는 것은, 이 배치 크기에서는 학습 과정에서 노이즈와 안정성 간의 균형이 애매하게 잡혔을 가능성이 높음.
      → 예를 들어, 배치 16보다 일반화 성능이 떨어지고, 배치 64, 128보다 학습이 안정되지 못했을 수 있다.

- acc-auc 분석
  - 정확도(acc): 모델이 0.5 이상이면 무조건 1(양성), 0.5 이하면 무조건 0(음성)으로 변환한 후 평가하는 지표
  - auc: 예측 확률 값 자체의 품질을 평가하는 지표(확률 기반 평)
  - 배치 64에서는 정확도가 더 높았지만, 모델이 **실제 확률 분포를 예측하는 능력(AUC)**은 배치 128이 더 뛰어날 수 있음.
  - 이는 배치 64에서는 과적합 경향이 생기거나, 모델이 좀 더 결정적인 예측(즉, 높은 확률로 0 또는 1을 예측)을 하지만, 실제로는 그게 최적의 방법이 아닐 수도 있다는 뜻

- 배치 사이즈에 따른 모델 학습 특징
  ![image](https://github.com/user-attachments/assets/e8f37b82-27b7-4cdb-9f64-d62713f219f0)

- final result: batch size가 16일때가 가장 최적이므로 resNet50모델을 이용해서 melanoma를 예측하려고 하면 resNet50-batch(16)을 이용해서 예측하는것이 가장 효과적이라 할 수 있음.
  

